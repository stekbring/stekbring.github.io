<!doctype html>
<html lang="sv">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Nedladdningar</title>
  <style>
    :root{font-family:Inter, system-ui, -apple-system, sans-serif;}
    body{min-height:100vh;display:flex;align-items:center;justify-content:center;background:#f6f7fb;margin:0}
    .wrapper{width:min(640px,95vw);background:#fff;padding:28px;border-radius:12px;box-shadow:0 8px 30px rgba(20,20,40,0.06);text-align:center}
    h1{margin:0 0 18px;font-size:24px}
    ul{list-style:none;padding:0;margin:0;display:flex;flex-direction:column;gap:10px;}
    li{display:flex;justify-content:space-between;align-items:center;padding:10px 12px;border:1px solid #e9e9ef;border-radius:8px}
    .name{overflow:hidden;text-overflow:ellipsis;white-space:nowrap;padding-right:12px;flex:1;text-align:left}
    .btn{text-decoration:none;padding:8px 12px;border-radius:8px;background:#1f6feb;color:#fff;font-weight:600;font-size:14px;border:0;cursor:pointer}
    .btn:hover{background:#1158c7}
    .status{color:#666;font-size:14px;margin-top:16px}
  </style>
</head>
<body>
  <main class="wrapper">
    <h1>Nedladdningar</h1>
    <ul id="list"></ul>
    <p class="status" id="status">Laddar...</p>
  </main>

  <script>
    // --- KONFIGURATION ---
    const ghUser = 'stekbring';  // Ändra till ditt GitHub-namn
    const ghRepo = 'stekbring.github.io';     // Ändra till namnet på ditt repository
    const ghFolder = 'downloads/filer';            // Mappen där dina zip-filer ligger
    // ---------------------

    const listEl = document.getElementById('list');
    const statusEl = document.getElementById('status');

    async function fetchFromGitHubAPI() {
      statusEl.textContent = 'Hämtar fil-lista från GitHub...';
      listEl.innerHTML = '';

      // URL till GitHubs API för innehåll
      const apiUrl = `https://api.github.com/repos/${ghUser}/${ghRepo}/contents/${ghFolder}`;

      try {
        const res = await fetch(apiUrl + '?t=' + new Date().getTime());
        
        if (res.status === 404) throw new Error('Hittade inte mappen eller repot. Kolla inställningarna.');
        if (res.status === 403) throw new Error('API-gräns nådd (vänta en stund) eller privat repo.');
        if (!res.ok) throw new Error('Kunde inte kontakta GitHub.');

        const data = await res.json();
        
        // Filtrera ut bara .zip-filer
        const zips = data.filter(item => item.name.toLowerCase().endsWith('.zip'));

        if (zips.length === 0) {
           statusEl.textContent = 'Inga .zip-filer hittades i mappen.';
           return;
        }

        renderList(zips);
      } catch (err) {
        console.error(err);
        statusEl.textContent = 'Fel: ' + err.message;
      }
    }

    function renderList(files) {
      files.forEach(file => {
        const li = document.createElement('li');
        
        const nameSpan = document.createElement('div'); 
        nameSpan.className = 'name'; 
        nameSpan.textContent = file.name;

        const a = document.createElement('a');
        // download_url är länken direkt till råfilen
        a.href = file.download_url; 
        a.textContent = 'Ladda ner';
        a.className = 'btn';

        li.appendChild(nameSpan);
        li.appendChild(a);
        listEl.appendChild(li);
      });
      statusEl.textContent = `${files.length} fil(er) hittade.`;
    }

    fetchFromGitHubAPI();
  </script>
</body>
</html>